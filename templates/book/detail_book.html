{% extends 'index.html' %}


{% block categories %}
{% endblock categories %}


{% block cover-page %}
    
{% endblock cover-page %}
    
    

{% block section %}
        
<section class="max-w-6xl text-center mx-auto px-4 sm:px-6 lg:px-4 py-12">
    <!-- book title -->
    <h1 class="font-bold text-3xl md:text-4xl lg:text-5xl font-heading capitalize text-gray-900">
        {{book.title}}
    </h1>
    <!-- author username -->
    <a href="{% url 'detail_author' book.author.username %}">
        <h2 class="text-base font-bold capitalize text-indigo-600">{{book.author.first_name}}</h2>
    </a>
    
    <br>
    <div class="grid grid-cols-1 gap-6">

        <!-- libro -->
        <div class="w-full bg-white rounded-lg sahdow-lg flex flex-col md:flex-row">
            <!-- foto -->
            <div class="w-full md:w-2/5 h-100">
                {% if book.photo %}
                    <img class="object-center rounded-lg object-cover w-full h-full" src="{{book.photo.url}}" alt="photo_book">
                {% else %}
                    <img class="object-center rounded-lg object-cover w-full h-full" src="https://2.bp.blogspot.com/-lvuSxpb1jXc/Ub5nTo-rPCI/AAAAAAAAWzw/q3aV2_kjgwI/s1600/libros+(1).jpg" alt="photo_book">
                {% endif %}
                <!-- read or download -->
                <div class="flex justify-around  items-end">
                    <a class="text-base text-left leading-relaxed text-white font-normal bg-red-400 rounded-lg px-3 my-2 shadow-lg" href="{{book.file.url}}">Leer / Descargar</a>
                    
                    {% if user.is_authenticated %}
                        {% if request.user.username == book.author.username %}
                            <a class="text-base text-left leading-relaxed text-white font-normal bg-blue-400 rounded-lg px-3 my-2 shadow-lg" href="{% url 'edit_book' book.slug %}">Editar Información</a>
                        {% endif %}
                    {% endif %}
                </div>
            </div>
            <div class="w-full my-5 md:w-4/5 text-left p-6 md:p-4 space-y-2 lg:my-0">
                <!-- nombres -->
                <p class="text-xl text-gray-700 font-bold capitalize">{{book.title}}</p>

                <!-- email -->
                <a href="#" class="text-base text-gray-400 font-normal capitalize">escrito por: {{book.author_book}}</a>

                <!-- descripcion -->
                <p class="text-base leading-relaxed text-gray-500 font-normal">{{book.synopsis}}</p>
            </div>
        </div>


        <!-- REVIEWERS -->


        <div class="my-5 lg:my-10">
            <!-- formulario de reseña -->
            <div class="bg-white my-5 lg:my-10 p-3 rounded-lg text-black border-l border-r border-gray-400">
                <h1 class="text-center font-bold border-b rounded-lg border-gray-400 text-xl text-gray-800">Escribe una reseña</h1>

                <!-- form -->
                <form method="POST" class=" border-gray-400 grid grid-cols-1 gap-2 p-3">
                    {% csrf_token %}

                    <!-- author -->
                    {% if user.is_authenticated %}
                        <input type="text" name="author" class="hidden" value="{{request.user.id}}">
                    {% endif %}
                        
                    <!-- book -->
                    <input type="text" name="book" class="hidden" value="{{book.id}}">

                    <!-- titulo -->
                    {{review_form.title}}
                    
                    <!-- mensaje -->
                    {{review_form.message}}

                    <!-- botón -->
                    <button class="text-center p-2 bg-blue-400 text-white rounded-lg">Publicar</button>
                </form>
            </div>

            {% for r in reviewer %}
                <!-- review -->
                <div class="bg-gray-200 w-full rounded-2xl px-10 py-6 shadow-lg hover:shadow-2xl transition duration-500">
                    <div class="lg:mt-2 mt-4">

                        <!-- titulo -->
                        {% if r.title %}
                            <h1 class="text-lg text-left text-gray-700 font-semibold">{{r.title}}</h1>
                        {% endif %}

                        <!-- estrellas -->
                        <div class="flex mt-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-yellow-400" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                            </svg>
                        </div>

                        <!-- contenido -->
                        <p class="mt-2 text-md text-left text-gray-600">{{r.message}}</p>

                        <div class="flex justify-between items-center">
                            <div class=" flex items-center space-x-4 py-6">
                                
                                <!-- imagen de perfil del autor -->
                                <a href="{% url 'detail_author' r.author %}">
                                    {% if r.author.photo %}
                                        <img class="w-12 h-12 rounded-full" src="{{r.author.photo.url}}" alt="photo_author" />
                                    {% else %}
                                        <img class="w-12 h-12 rounded-full" src="https://as2.ftcdn.net/v2/jpg/00/65/77/27/500_F_65772719_A1UV5kLi5nCEWI0BNLLiFaBPEkUbv5Fv.jpg" alt="photo_author"/>
                                    {% endif %}
                                </a>
                                
                                <!-- nombre del autor y fecha de comenterio -->
                                <div class="text-sm font-semibold">{{r.author.first_name}} • <span class="font-normal">{{r.date}}</span></div>
                            </div>

                            <!-- eliminacion, edicion -->
                            {% if user.is_authenticated %}
                                {% if request.user.username == r.author.username %}
                                    <div class="text-right">
                                        <a href="#" class="p-2 rounded-lg bg-blue-400 hover:bg-blue-500 text-white">editar</a>
                                        <a href="{% url 'delete_review' r.id %}" class="p-2 rounded-lg bg-red-400 hover:bg-red-500 text-white">Eliminar</a>
                                    </div>
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>
                </div>
                <br>
            {% endfor %}
        </div>
    </div>
</section>
        
{% endblock section %}
